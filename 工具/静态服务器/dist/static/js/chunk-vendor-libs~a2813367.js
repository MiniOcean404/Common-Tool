"use strict";(self.webpackChunkgame_camp_2d=self.webpackChunkgame_camp_2d||[]).push([[462],{5155:function(t,e,i){i.d(e,{$o:function(){return n},S:function(){return r},TC:function(){return N}});var r,n,s=i(8924),h=i(2997),a=i(3588),o=i(5501),l=i(536);!function(t){t.MITER="miter",t.BEVEL="bevel",t.ROUND="round"}(r||(r={})),function(t){t.BUTT="butt",t.ROUND="round",t.SQUARE="square"}(n||(n={}));var u={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var i=Math.ceil(t/this.maxLength);return i<this.minSegments?i=this.minSegments:i>this.maxSegments&&(i=this.maxSegments),i}},p=function(){function t(){this.color=16777215,this.alpha=1,this.texture=s.xE.WHITE,this.matrix=null,this.visible=!1,this.reset()}return t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},t.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=s.xE.WHITE,this.matrix=null,this.visible=!1},t.prototype.destroy=function(){this.texture=null,this.matrix=null},t}(),c=function(t,e){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},c(t,e)};function f(t,e){function i(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}function d(t,e){var i,r;void 0===e&&(e=!1);var n=t.length;if(!(n<6)){for(var s=0,h=0,a=t[n-2],o=t[n-1];h<n;h+=2){var l=t[h],u=t[h+1];s+=(l-a)*(u+o),a=l,o=u}if(!e&&s>0||e&&s<=0){var p=n/2;for(h=p+p%2;h<n;h+=2){var c=n-h-2,f=n-h-1,d=h,y=h+1;i=[t[d],t[c]],t[c]=i[0],t[d]=i[1],r=[t[y],t[f]],t[f]=r[0],t[y]=r[1]}}}}var y={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var i=t.points,r=t.holes,n=e.points,s=e.indices;if(i.length>=6){d(i,!1);for(var h=[],o=0;o<r.length;o++){var l=r[o];d(l.points,!0),h.push(i.length/2),i=i.concat(l.points)}var u=(0,a.OT)(i,h,2);if(!u)return;var p=n.length/2;for(o=0;o<u.length;o+=3)s.push(u[o]+p),s.push(u[o+1]+p),s.push(u[o+2]+p);for(o=0;o<i.length;o++)n.push(i[o])}}},v={build:function(t){var e,i,r,n,s,a,o=t.points;if(t.type===h.HS.CIRC){var l=t.shape;e=l.x,i=l.y,s=a=l.radius,r=n=0}else if(t.type===h.HS.ELIP){var u=t.shape;e=u.x,i=u.y,s=u.width,a=u.height,r=n=0}else{var p=t.shape,c=p.width/2,f=p.height/2;e=p.x+c,i=p.y+f,r=c-(s=a=Math.max(0,Math.min(p.radius,Math.min(c,f)))),n=f-a}if(s>=0&&a>=0&&r>=0&&n>=0){var d=Math.ceil(2.3*Math.sqrt(s+a)),y=8*d+(r?4:0)+(n?4:0);if(o.length=y,0!==y){if(0===d)return o.length=8,o[0]=o[6]=e+r,o[1]=o[3]=i+n,o[2]=o[4]=e-r,void(o[5]=o[7]=i-n);var v=0,g=4*d+(r?2:0)+2,b=g,m=y,x=e+(T=r+s),_=e-T,w=i+(D=n);if(o[v++]=x,o[v++]=w,o[--g]=w,o[--g]=_,n){var S=i-D;o[b++]=_,o[b++]=S,o[--m]=S,o[--m]=x}for(var M=1;M<d;M++){var P=Math.PI/2*(M/d);x=e+(T=r+Math.cos(P)*s),_=e-T,w=i+(D=n+Math.sin(P)*a),S=i-D;o[v++]=x,o[v++]=w,o[--g]=w,o[--g]=_,o[b++]=_,o[b++]=S,o[--m]=S,o[--m]=x}var T,D;x=e+(T=r),_=e-T,w=i+(D=n+a),S=i-D;o[v++]=x,o[v++]=w,o[--m]=S,o[--m]=x,r&&(o[v++]=_,o[v++]=w,o[--m]=S,o[--m]=_)}}else o.length=0},triangulate:function(t,e){var i,r,n=t.points,s=e.points,a=e.indices,o=s.length/2,l=o;if(t.type!==h.HS.RREC){var u=t.shape;i=u.x,r=u.y}else{var p=t.shape;i=p.x+p.width/2,r=p.y+p.height/2}var c=t.matrix;s.push(t.matrix?c.a*i+c.c*r+c.tx:i,t.matrix?c.b*i+c.d*r+c.ty:r),o++,s.push(n[0],n[1]);for(var f=2;f<n.length;f+=2)s.push(n[f],n[f+1]),a.push(o++,l,o);a.push(l+1,l,o)}},g={build:function(t){var e=t.shape,i=e.x,r=e.y,n=e.width,s=e.height,h=t.points;h.length=0,h.push(i,r,i+n,r,i+n,r+s,i,r+s)},triangulate:function(t,e){var i=t.points,r=e.points,n=r.length/2;r.push(i[0],i[1],i[2],i[3],i[6],i[7],i[4],i[5]),e.indices.push(n,n+1,n+2,n+1,n+2,n+3)}};function b(t,e,i){return t+(e-t)*i}function m(t,e,i,r,n,s,h){void 0===h&&(h=[]);for(var a=h,o=0,l=0,u=0,p=0,c=0,f=0,d=0,y=0;d<=20;++d)o=b(t,i,y=d/20),l=b(e,r,y),u=b(i,n,y),p=b(r,s,y),c=b(o,u,y),f=b(l,p,y),0===d&&a[a.length-2]===c&&a[a.length-1]===f||a.push(c,f);return a}var x={build:function(t){if(N.nextRoundedRectBehavior)v.build(t);else{var e=t.shape,i=t.points,r=e.x,n=e.y,s=e.width,h=e.height,a=Math.max(0,Math.min(e.radius,Math.min(s,h)/2));i.length=0,a?(m(r,n+a,r,n,r+a,n,i),m(r+s-a,n,r+s,n,r+s,n+a,i),m(r+s,n+h-a,r+s,n+h,r+s-a,n+h,i),m(r+a,n+h,r,n+h,r,n+h-a,i)):i.push(r,n,r+s,n,r+s,n+h,r,n+h)}},triangulate:function(t,e){if(N.nextRoundedRectBehavior)v.triangulate(t,e);else{for(var i=t.points,r=e.points,n=e.indices,s=r.length/2,h=(0,a.OT)(i,null,2),o=0,l=h.length;o<l;o+=3)n.push(h[o]+s),n.push(h[o+1]+s),n.push(h[o+2]+s);for(o=0,l=i.length;o<l;o++)r.push(i[o],i[++o])}}};function _(t,e,i,r,n,s,h,a){var o,l;h?(o=r,l=-i):(o=-r,l=i);var u=t-i*n+o,p=e-r*n+l,c=t+i*s+o,f=e+r*s+l;return a.push(u,p),a.push(c,f),2}function w(t,e,i,r,n,s,h,a){var o=i-t,l=r-e,u=Math.atan2(o,l),p=Math.atan2(n-t,s-e);a&&u<p?u+=2*Math.PI:!a&&u>p&&(p+=2*Math.PI);var c=u,f=p-u,d=Math.abs(f),y=Math.sqrt(o*o+l*l),v=1+(15*d*Math.sqrt(y)/Math.PI>>0),g=f/v;if(c+=g,a){h.push(t,e),h.push(i,r);for(var b=1,m=c;b<v;b++,m+=g)h.push(t,e),h.push(t+Math.sin(m)*y,e+Math.cos(m)*y);h.push(t,e),h.push(n,s)}else{h.push(i,r),h.push(t,e);for(b=1,m=c;b<v;b++,m+=g)h.push(t+Math.sin(m)*y,e+Math.cos(m)*y),h.push(t,e);h.push(n,s),h.push(t,e)}return 2*v}function S(t,e){t.lineStyle.native?function(t,e){var i=0,r=t.shape,n=t.points||r.points,s=r.type!==h.HS.POLY||r.closeStroke;if(0!==n.length){var a=e.points,o=e.indices,l=n.length/2,u=a.length/2,p=u;for(a.push(n[0],n[1]),i=1;i<l;i++)a.push(n[2*i],n[2*i+1]),o.push(p,p+1),p++;s&&o.push(p,u)}}(t,e):function(t,e){var i=t.shape,s=t.points||i.points.slice(),a=e.closePointEps;if(0!==s.length){var o=t.lineStyle,l=new h.E9(s[0],s[1]),p=new h.E9(s[s.length-2],s[s.length-1]),c=i.type!==h.HS.POLY||i.closeStroke,f=Math.abs(l.x-p.x)<a&&Math.abs(l.y-p.y)<a;if(c){s=s.slice(),f&&(s.pop(),s.pop(),p.set(s[s.length-2],s[s.length-1]));var d=.5*(l.x+p.x),y=.5*(p.y+l.y);s.unshift(d,y),s.push(d,y)}var v=e.points,g=s.length/2,b=s.length,m=v.length/2,x=o.width/2,S=x*x,M=o.miterLimit*o.miterLimit,P=s[0],T=s[1],D=s[2],E=s[3],I=0,C=0,A=-(T-E),R=P-D,B=0,L=0,O=Math.sqrt(A*A+R*R);A/=O,R/=O,A*=x,R*=x;var U=o.alignment,H=2*(1-U),j=2*U;c||(o.cap===n.ROUND?b+=w(P-A*(H-j)*.5,T-R*(H-j)*.5,P-A*H,T-R*H,P+A*j,T+R*j,v,!0)+2:o.cap===n.SQUARE&&(b+=_(P,T,A,R,H,j,!0,v))),v.push(P-A*H,T-R*H),v.push(P+A*j,T+R*j);for(var N=1;N<g-1;++N){P=s[2*(N-1)],T=s[2*(N-1)+1],D=s[2*N],E=s[2*N+1],I=s[2*(N+1)],C=s[2*(N+1)+1],A=-(T-E),R=P-D,A/=O=Math.sqrt(A*A+R*R),R/=O,A*=x,R*=x,B=-(E-C),L=D-I,B/=O=Math.sqrt(B*B+L*L),L/=O,B*=x,L*=x;var F=D-P,k=T-E,z=D-I,q=C-E,Y=k*z-q*F,G=Y<0;if(Math.abs(Y)<.1)v.push(D-A*H,E-R*H),v.push(D+A*j,E+R*j);else{var V=(-A+P)*(-R+E)-(-A+D)*(-R+T),W=(-B+I)*(-L+E)-(-B+D)*(-L+C),Z=(F*W-z*V)/Y,X=(q*V-k*W)/Y,$=(Z-D)*(Z-D)+(X-E)*(X-E),Q=D+(Z-D)*H,K=E+(X-E)*H,J=D-(Z-D)*j,tt=E-(X-E)*j,et=G?H:j;$<=Math.min(F*F+k*k,z*z+q*q)+et*et*S?o.join===r.BEVEL||$/S>M?(G?(v.push(Q,K),v.push(D+A*j,E+R*j),v.push(Q,K),v.push(D+B*j,E+L*j)):(v.push(D-A*H,E-R*H),v.push(J,tt),v.push(D-B*H,E-L*H),v.push(J,tt)),b+=2):o.join===r.ROUND?G?(v.push(Q,K),v.push(D+A*j,E+R*j),b+=w(D,E,D+A*j,E+R*j,D+B*j,E+L*j,v,!0)+4,v.push(Q,K),v.push(D+B*j,E+L*j)):(v.push(D-A*H,E-R*H),v.push(J,tt),b+=w(D,E,D-A*H,E-R*H,D-B*H,E-L*H,v,!1)+4,v.push(D-B*H,E-L*H),v.push(J,tt)):(v.push(Q,K),v.push(J,tt)):(v.push(D-A*H,E-R*H),v.push(D+A*j,E+R*j),o.join===r.ROUND?b+=G?w(D,E,D+A*j,E+R*j,D+B*j,E+L*j,v,!0)+2:w(D,E,D-A*H,E-R*H,D-B*H,E-L*H,v,!1)+2:o.join===r.MITER&&$/S<=M&&(G?(v.push(J,tt),v.push(J,tt)):(v.push(Q,K),v.push(Q,K)),b+=2),v.push(D-B*H,E-L*H),v.push(D+B*j,E+L*j),b+=2)}}P=s[2*(g-2)],T=s[2*(g-2)+1],D=s[2*(g-1)],A=-(T-(E=s[2*(g-1)+1])),R=P-D,A/=O=Math.sqrt(A*A+R*R),R/=O,A*=x,R*=x,v.push(D-A*H,E-R*H),v.push(D+A*j,E+R*j),c||(o.cap===n.ROUND?b+=w(D-A*(H-j)*.5,E-R*(H-j)*.5,D-A*H,E-R*H,D+A*j,E+R*j,v,!1)+2:o.cap===n.SQUARE&&(b+=_(D,E,A,R,H,j,!1,v)));var it=e.indices,rt=u.epsilon*u.epsilon;for(N=m;N<b+m-2;++N)P=v[2*N],T=v[2*N+1],D=v[2*(N+1)],E=v[2*(N+1)+1],I=v[2*(N+2)],C=v[2*(N+2)+1],Math.abs(P*(E-C)+D*(C-T)+I*(T-E))<rt||it.push(N,N+1,N+2)}}(t,e)}var M,P=function(){function t(){}return t.curveTo=function(t,e,i,r,n,s){var h=s[s.length-2],a=s[s.length-1]-e,o=h-t,l=r-e,u=i-t,p=Math.abs(a*u-o*l);if(p<1e-8||0===n)return s[s.length-2]===t&&s[s.length-1]===e||s.push(t,e),null;var c=a*a+o*o,f=l*l+u*u,d=a*l+o*u,y=n*Math.sqrt(c)/p,v=n*Math.sqrt(f)/p,g=y*d/c,b=v*d/f,m=y*u+v*o,x=y*l+v*a,_=o*(v+g),w=a*(v+g),S=u*(y+b),M=l*(y+b);return{cx:m+t,cy:x+e,radius:n,startAngle:Math.atan2(w-x,_-m),endAngle:Math.atan2(M-x,S-m),anticlockwise:o*l>u*a}},t.arc=function(t,e,i,r,n,s,a,o,l){for(var p=a-s,c=u._segmentsCount(Math.abs(p)*n,40*Math.ceil(Math.abs(p)/h._b)),f=p/(2*c),d=2*f,y=Math.cos(f),v=Math.sin(f),g=c-1,b=g%1/g,m=0;m<=g;++m){var x=f+s+d*(m+b*m),_=Math.cos(x),w=-Math.sin(x);l.push((y*_+v*w)*n+i,(y*-w+v*_)*n+r)}},t}(),T=function(){function t(){}return t.curveLength=function(t,e,i,r,n,s,h,a){for(var o=0,l=0,u=0,p=0,c=0,f=0,d=0,y=0,v=0,g=0,b=0,m=t,x=e,_=1;_<=10;++_)g=m-(y=(d=(f=(c=1-(l=_/10))*c)*c)*t+3*f*l*i+3*c*(u=l*l)*n+(p=u*l)*h),b=x-(v=d*e+3*f*l*r+3*c*u*s+p*a),m=y,x=v,o+=Math.sqrt(g*g+b*b);return o},t.curveTo=function(e,i,r,n,s,h,a){var o=a[a.length-2],l=a[a.length-1];a.length-=2;var p=u._segmentsCount(t.curveLength(o,l,e,i,r,n,s,h)),c=0,f=0,d=0,y=0,v=0;a.push(o,l);for(var g=1,b=0;g<=p;++g)d=(f=(c=1-(b=g/p))*c)*c,v=(y=b*b)*b,a.push(d*o+3*f*b*e+3*c*y*r+v*s,d*l+3*f*b*i+3*c*y*n+v*h)},t}(),D=function(){function t(){}return t.curveLength=function(t,e,i,r,n,s){var h=t-2*i+n,a=e-2*r+s,o=2*i-2*t,l=2*r-2*e,u=4*(h*h+a*a),p=4*(h*o+a*l),c=o*o+l*l,f=2*Math.sqrt(u+p+c),d=Math.sqrt(u),y=2*u*d,v=2*Math.sqrt(c),g=p/d;return(y*f+d*p*(f-v)+(4*c*u-p*p)*Math.log((2*d+g+f)/(g+v)))/(4*y)},t.curveTo=function(e,i,r,n,s){for(var h=s[s.length-2],a=s[s.length-1],o=u._segmentsCount(t.curveLength(h,a,e,i,r,n)),l=0,p=0,c=1;c<=o;++c){var f=c/o;l=h+(e-h)*f,p=a+(i-a)*f,s.push(l+(e+(r-e)*f-l)*f,p+(i+(n-i)*f-p)*f)}},t}(),E=function(){function t(){this.reset()}return t.prototype.begin=function(t,e,i){this.reset(),this.style=t,this.start=e,this.attribStart=i},t.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},t.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},t}(),I=((M={})[h.HS.POLY]=y,M[h.HS.CIRC]=v,M[h.HS.ELIP]=v,M[h.HS.RECT]=g,M[h.HS.RREC]=x,M),C=[],A=[],R=function(){function t(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null),this.points=[],this.holes=[],this.shape=t,this.lineStyle=i,this.fillStyle=e,this.matrix=r,this.type=t.type}return t.prototype.clone=function(){return new t(this.shape,this.fillStyle,this.lineStyle,this.matrix)},t.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},t}(),B=new h.E9,L=new l.YZ,O=function(t){function e(){var e=t.call(this)||this;return e.closePointEps=1e-4,e.boundsPadding=0,e.uvsFloat32=null,e.indicesUint16=null,e.batchable=!1,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.drawCalls=[],e.batchDirty=-1,e.batches=[],e.dirty=0,e.cacheDirty=-1,e.clearDirty=0,e.shapeIndex=0,e._bounds=new l.YZ,e.boundsDirty=-1,e}return f(e,t),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),A.push(this.drawCalls[t]);this.drawCalls.length=0;for(t=0;t<this.batches.length;t++){var e=this.batches[t];e.reset(),C.push(e)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null);var n=new R(t,e,i,r);return this.graphicsData.push(n),this.dirty++,this},e.prototype.drawHole=function(t,e){if(void 0===e&&(e=null),!this.graphicsData.length)return null;var i=new R(t,null,null,e),r=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=r.lineStyle,r.holes.push(i),this.dirty++,this},e.prototype.destroy=function(){t.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,i=0;i<e.length;++i){var r=e[i];if(r.fillStyle.visible&&(r.shape&&(r.matrix?r.matrix.applyInverse(t,B):B.copyFrom(t),r.shape.contains(B.x,B.y)))){var n=!1;if(r.holes)for(var s=0;s<r.holes.length;s++){if(r.holes[s].shape.contains(B.x,B.y)){n=!0;break}}if(!n)return!0}}return!1},e.prototype.updateBatches=function(t){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var e=this.uvs,i=this.graphicsData,r=null,n=null;this.batches.length>0&&(n=(r=this.batches[this.batches.length-1]).style);for(var s=this.shapeIndex;s<i.length;s++){this.shapeIndex++;var h=i[s],a=h.fillStyle,l=h.lineStyle;I[h.type].build(h),h.matrix&&this.transformPoints(h.points,h.matrix),(a.visible||l.visible)&&this.processHoles(h.holes);for(var u=0;u<2;u++){var p=0===u?a:l;if(p.visible){var c=p.texture.baseTexture,f=this.indices.length,d=this.points.length/2;c.wrapMode=o.Nt.REPEAT,0===u?this.processFill(h):this.processLine(h);var y=this.points.length/2-d;0!==y&&(r&&!this._compareStyles(n,p)&&(r.end(f,d),r=null),r||((r=C.pop()||new E).begin(p,f,d),this.batches.push(r),n=p),this.addUvs(this.points,e,p.texture,d,y,p.matrix))}}}var v=this.indices.length,g=this.points.length/2;if(r&&r.end(v,g),0!==this.batches.length){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var b=g>65535&&t;this.indicesUint16=b?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},e.prototype._compareStyles=function(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native===!!e.native))},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var i=this.graphicsData[t],r=i.fillStyle,n=i.lineStyle;if(r&&!r.texture.baseTexture.valid)return!1;if(n&&!n.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,i=t.length;e<i;e++)for(var r=t[e],n=0;n<r.size;n++){var s=r.start+n;this.indicesUint16[s]=this.indicesUint16[s]-r.attribStart}},e.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var t=this.batches,i=0;i<t.length;i++)if(t[i].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++s.VL._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),A.push(this.drawCalls[e]);this.drawCalls.length=0;var i=this.colors,r=this.textureIds,n=A.pop();n||((n=new s.a$).texArray=new s.Ie),n.texArray.count=0,n.start=0,n.size=0,n.type=o.lg.TRIANGLES;var h=0,a=null,l=0,u=!1,p=o.lg.TRIANGLES,c=0;this.drawCalls.push(n);for(e=0;e<this.batches.length;e++){var f=this.batches[e],d=f.style,y=d.texture.baseTexture;u!==!!d.native&&(p=(u=!!d.native)?o.lg.LINES:o.lg.TRIANGLES,a=null,h=8,t++),a!==y&&(a=y,y._batchEnabled!==t&&(8===h&&(t++,h=0,n.size>0&&((n=A.pop())||((n=new s.a$).texArray=new s.Ie),this.drawCalls.push(n)),n.start=c,n.size=0,n.texArray.count=0,n.type=p),y.touched=1,y._batchEnabled=t,y._batchLocation=h,y.wrapMode=o.Nt.REPEAT,n.texArray.elements[n.texArray.count++]=y,h++)),n.size+=f.size,c+=f.size,l=y._batchLocation,this.addColors(i,d.color,d.alpha,f.attribSize,f.attribStart),this.addTextureIds(r,l,f.attribSize,f.attribStart)}s.VL._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,i=this.colors,r=this.textureIds,n=new ArrayBuffer(3*t.length*4),s=new Float32Array(n),h=new Uint32Array(n),a=0,o=0;o<t.length/2;o++)s[a++]=t[2*o],s[a++]=t[2*o+1],s[a++]=e[2*o],s[a++]=e[2*o+1],h[a++]=i[o],s[a++]=r[o];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){t.holes.length?y.triangulate(t,this):I[t.type].triangulate(t,this)},e.prototype.processLine=function(t){S(t,this);for(var e=0;e<t.holes.length;e++)S(t.holes[e],this)},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var i=t[e];I[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds,e=L,i=h.y3.IDENTITY;this._bounds.clear(),e.clear();for(var r=0;r<this.graphicsData.length;r++){var n=this.graphicsData[r],s=n.shape,a=n.type,o=n.lineStyle,l=n.matrix||h.y3.IDENTITY,u=0;if(o&&o.visible&&(u=o.width,a!==h.HS.POLY||n.fillStyle.visible?u*=Math.max(0,o.alignment):u*=Math.max(o.alignment,1-o.alignment)),i!==l&&(e.isEmpty()||(t.addBoundsMatrix(e,i),e.clear()),i=l),a===h.HS.RECT||a===h.HS.RREC){var p=s;e.addFramePad(p.x,p.y,p.x+p.width,p.y+p.height,u,u)}else if(a===h.HS.CIRC){var c=s;e.addFramePad(c.x,c.y,c.x,c.y,c.radius+u,c.radius+u)}else if(a===h.HS.ELIP){var f=s;e.addFramePad(f.x,f.y,f.x,f.y,f.width+u,f.height+u)}else{var d=s;t.addVerticesMatrix(i,d.points,0,d.points.length,u,u)}}e.isEmpty()||t.addBoundsMatrix(e,i),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,e){for(var i=0;i<t.length/2;i++){var r=t[2*i],n=t[2*i+1];t[2*i]=e.a*r+e.c*n+e.tx,t[2*i+1]=e.b*r+e.d*n+e.ty}},e.prototype.addColors=function(t,e,i,r,n){void 0===n&&(n=0);var s=(e>>16)+(65280&e)+((255&e)<<16),h=(0,a.rA)(s,i);t.length=Math.max(t.length,n+r);for(var o=0;o<r;o++)t[n+o]=h},e.prototype.addTextureIds=function(t,e,i,r){void 0===r&&(r=0),t.length=Math.max(t.length,r+i);for(var n=0;n<i;n++)t[r+n]=e},e.prototype.addUvs=function(t,e,i,r,n,s){void 0===s&&(s=null);for(var h=0,a=e.length,o=i.frame;h<n;){var l=t[2*(r+h)],u=t[2*(r+h)+1];if(s){var p=s.a*l+s.c*u+s.tx;u=s.b*l+s.d*u+s.ty,l=p}h++,e.push(l/o.width,u/o.height)}var c=i.baseTexture;(o.width<c.width||o.height<c.height)&&this.adjustUvs(e,i,a,n)},e.prototype.adjustUvs=function(t,e,i,r){for(var n=e.baseTexture,s=1e-6,h=i+2*r,a=e.frame,o=a.width/n.width,l=a.height/n.height,u=a.x/a.width,p=a.y/a.height,c=Math.floor(t[i]+s),f=Math.floor(t[i+1]+s),d=i+2;d<h;d+=2)c=Math.min(c,Math.floor(t[d]+s)),f=Math.min(f,Math.floor(t[d+1]+s));u-=c,p-=f;for(d=i;d<h;d+=2)t[d]=(t[d]+u)*o,t[d+1]=(t[d+1]+p)*l},e.BATCHABLE_SIZE=100,e}(s.JZ),U=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=n.BUTT,e.join=r.MITER,e.miterLimit=10,e}return f(e,t),e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},e}(p),H=new Float32Array(3),j={},N=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i.shader=null,i.pluginName="batch",i.currentPath=null,i.batches=[],i.batchTint=-1,i.batchDirty=-1,i.vertexData=null,i._fillStyle=new p,i._lineStyle=new U,i._matrix=null,i._holeMode=!1,i.state=s.ZM.for2d(),i._geometry=e||new O,i._geometry.refCount++,i._transformID=-1,i.tint=16777215,i.blendMode=o.T$.NORMAL,i}return f(e,t),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return this.finishPoly(),new e(this._geometry)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),e.prototype.lineStyle=function(t,e,i,r,n){return void 0===t&&(t=null),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=.5),void 0===n&&(n=!1),"number"===typeof t&&(t={width:t,color:e,alpha:i,alignment:r,native:n}),this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){t=Object.assign({width:0,texture:s.xE.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:n.BUTT,join:r.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var e=t.width>0&&t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:e},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new h.mg,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new h.mg,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},e.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var i=this.currentPath.points,r=i[i.length-2],n=i[i.length-1];return r===t&&n===e||i.push(t,e),this},e.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},e.prototype.quadraticCurveTo=function(t,e,i,r){this._initCurve();var n=this.currentPath.points;return 0===n.length&&this.moveTo(0,0),D.curveTo(t,e,i,r,n),this},e.prototype.bezierCurveTo=function(t,e,i,r,n,s){return this._initCurve(),T.curveTo(t,e,i,r,n,s,this.currentPath.points),this},e.prototype.arcTo=function(t,e,i,r,n){this._initCurve(t,e);var s=this.currentPath.points,h=P.curveTo(t,e,i,r,n,s);if(h){var a=h.cx,o=h.cy,l=h.radius,u=h.startAngle,p=h.endAngle,c=h.anticlockwise;this.arc(a,o,l,u,p,c)}return this},e.prototype.arc=function(t,e,i,r,n,s){if(void 0===s&&(s=!1),r===n)return this;if(!s&&n<=r?n+=h._b:s&&r<=n&&(r+=h._b),0===n-r)return this;var a=t+Math.cos(r)*i,o=e+Math.sin(r)*i,l=this._geometry.closePointEps,u=this.currentPath?this.currentPath.points:null;if(u){var p=Math.abs(u[u.length-2]-a),c=Math.abs(u[u.length-1]-o);p<l&&c<l||u.push(a,o)}else this.moveTo(a,o),u=this.currentPath.points;return P.arc(a,o,t,e,i,r,n,s,u),this},e.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:s.xE.WHITE,color:t,alpha:e})},e.prototype.beginTextureFill=function(t){t=Object.assign({texture:s.xE.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var e=t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:e},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,e,i,r){return this.drawShape(new h.Ae(t,e,i,r))},e.prototype.drawRoundedRect=function(t,e,i,r,n){return this.drawShape(new h.c9(t,e,i,r,n))},e.prototype.drawCircle=function(t,e,i){return this.drawShape(new h.Cd(t,e,i))},e.prototype.drawEllipse=function(t,e,i,r){return this.drawShape(new h.Pj(t,e,i,r))},e.prototype.drawPolygon=function(){for(var t,e=arguments,i=[],r=0;r<arguments.length;r++)i[r]=e[r];var n=!0,s=i[0];s.points?(n=s.closeStroke,t=s.points):t=Array.isArray(i[0])?i[0]:i;var a=new h.mg(t);return a.closeStroke=n,this.drawShape(a),this},e.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return 1===t.length&&t[0].shape.type===h.HS.RECT&&!t[0].matrix&&!t[0].holes.length&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)},e.prototype._render=function(t){this.finishPoly();var e=this._geometry,i=t.context.supports.uint32Indices;e.updateBatches(i),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this._geometry,e=this.blendMode,i=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(t.points);for(var r=0;r<i;r++){var n=t.batches[r],s=n.style.color,h=new Float32Array(this.vertexData.buffer,4*n.attribStart*2,2*n.attribSize),o=new Float32Array(t.uvsFloat32.buffer,4*n.attribStart*2,2*n.attribSize),l={vertexData:h,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*n.start,n.size),uvs:o,_batchRGB:(0,a.wK)(s),_tintRGB:s,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[r]=l}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,i=this.batches.length;e<i;e++){var r=this.batches[e];r.worldAlpha=this.worldAlpha*r.alpha,t.plugins[this.pluginName].render(r)}}},e.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),i=this._geometry,r=this.tint,n=this.worldAlpha,s=e.uniforms,h=i.drawCalls;s.translationMatrix=this.transform.worldTransform,s.tint[0]=(r>>16&255)/255*n,s.tint[1]=(r>>8&255)/255*n,s.tint[2]=(255&r)/255*n,s.tint[3]=n,t.shader.bind(e),t.geometry.bind(i,e),t.state.set(this.state);for(var a=0,o=h.length;a<o;a++)this._renderDrawCallDirect(t,i.drawCalls[a])},e.prototype._renderDrawCallDirect=function(t,e){for(var i=e.texArray,r=e.type,n=e.size,s=e.start,h=i.count,a=0;a<h;a++)t.texture.bind(i.elements[a],a);t.geometry.draw(r,n,s)},e.prototype._resolveDirectShader=function(t){var e=this.shader,i=this.pluginName;if(!e){if(!j[i]){for(var r=t.plugins[i].MAX_TEXTURES,n=new Int32Array(r),a=0;a<r;a++)n[a]=a;var o={tint:new Float32Array([1,1,1,1]),translationMatrix:new h.y3,default:s.oo.from({uSamplers:n},!0)},l=t.plugins[i]._shader.program;j[i]=new s.ex(l,o)}e=j[i]}return e},e.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var e=t.bounds,i=e.minX,r=e.minY,n=e.maxX,s=e.maxY;this._bounds.addFrame(this.transform,i,r,n,s)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=(0,a.wK)(this.tint,H),e=0;e<this.batches.length;e++){var i=this.batches[e],r=i._batchRGB,n=(t[0]*r[0]*255<<16)+(t[1]*r[1]*255<<8)+(0|t[2]*r[2]*255);i._tintRGB=(n>>16)+(65280&n)+((255&n)<<16)}}},e.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var e=this.transform.worldTransform,i=e.a,r=e.b,n=e.c,s=e.d,h=e.tx,a=e.ty,o=this._geometry.points,l=this.vertexData,u=0,p=0;p<o.length;p+=2){var c=o[p],f=o[p+1];l[u++]=i*c+n*f+h,l[u++]=s*f+r*c+a}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(e){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e)},e.nextRoundedRectBehavior=!1,e._TEMP_POINT=new h.E9,e}(l.W2)}}]);